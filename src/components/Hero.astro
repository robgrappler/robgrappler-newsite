---

---

<section
  class="fixed top-0 left-0 right-0 z-0 overflow-hidden border-b border-rg-purpleDeep/60 bg-rg-black h-screen"
>
  <!-- Background video + gradients -->
  <div class="absolute inset-0 bg-blue-500">
    <video
      id="hero-video"
      class="absolute inset-0 w-full h-full object-cover z-10"
      autoplay
      muted
      loop
      playsinline
      poster="/media/HERO_POSTER.jpg"
      aria-hidden="true"
      style="background: red;"
    >
      <source src="/media/HERO_LOOP_720p.mp4" type="video/mp4">
      <source src="/media/HERO_LOOP_1080p.mp4" type="video/mp4">
      <source src="/media/HERO_LOOP_1440p.mp4" type="video/mp4">
    </video>
    <!-- Textured Overlay -->
    <div
      class="absolute inset-0 opacity-30 mix-blend-soft-light"
      style="background-image: url('data:image/svg+xml;utf8,<svg viewBox=%220 0 200 200%22 xmlns=%22http://www.w3.org/2000/svg%22><filter id=%22noise%22><feTurbulence type=%22fractalNoise%22 baseFrequency=%220.65%22 numOctaves=%223%22 stitchTiles=%22stitch%22/></filter><rect width=%22100%25%22 height=%22100%25%22 filter=%22url(%23noise)%22 opacity=%221%22/></svg>')"
      aria-hidden="true"
    >
    </div>
    <div
      class="absolute inset-0 bg-gradient-to-t from-black via-black/40 to-black/10"
      aria-hidden="true"
    >
    </div>
    <div
      class="absolute inset-0 bg-[radial-gradient(circle_at_0_0,rgba(245,194,101,0.09),transparent_60%),radial-gradient(circle_at_100%_100%,rgba(245,194,101,0.12),transparent_55%)] mix-blend-soft-light"
      aria-hidden="true"
    >
    </div>
  </div>

  <div class="relative">
    <div class="rg-scanline"></div>
    <div
      class="rg-shell h-screen flex flex-col items-center justify-between text-center"
    >
      <!-- Top Content (Title) -->
      <div
        class="flex flex-col items-center w-full z-10 opacity-0 animate-fade-in-up"
        style="animation-delay: 0.1s"
      >
        <!-- Badge -->
        <div
          class="mb-6 rounded-full border border-rg-gold/30 bg-rg-gold/10 px-4 py-1.5 backdrop-blur-md"
        >
          <span
            class="text-[10px] font-bold uppercase tracking-[0.2em] text-rg-gold"
          >
            Private Match Archive // Secure
          </span>
        </div>

        <!-- Headline -->
        <h1
          class="font-display font-bold text-7xl sm:text-8xl md:text-9xl lg:text-[10rem] xl:text-[12rem] leading-[0.8] tracking-[-0.02em] uppercase text-[#ECE7DD] drop-shadow-[0_0_35px_rgba(0,0,0,0.8)]"
          style="font-weight: 700;"
        >
          Underground<br />Grappling<span class="text-rg-gold">.</span>
        </h1>
      </div>

      <!-- Bottom Content (Actions) -->
      <div
        class="flex flex-col items-center w-full sm:mt-6 z-10 opacity-0 animate-fade-in-up"
        style="animation-delay: 0.3s"
      >
        <!-- Subcopy -->
        <p
          class="mb-10 max-w-2xl text-base sm:text-lg font-medium text-zinc-300 drop-shadow-md leading-relaxed"
        >
          No scripts. No fluff. Just raw pressure and technical dominance.<br />
          Access the uncensored library of high-level submission wrestling.
        </p>

        <!-- CTAs -->
        <div
          class="flex flex-col items-center gap-6 sm:flex-row sm:justify-center w-full sm:w-auto px-4 sm:px-0"
        >
          <a
            href="https://www.watchfighters.com/channels/Robgrappler"
            class="btn-brutal brutal-shadow-white btn-striped group relative inline-flex w-full sm:w-auto items-center justify-center bg-rg-gold px-10 py-4 text-sm font-bold tracking-[0.2em] uppercase text-black transition-all"
          >
            <span class="relative z-10">Watch full matches</span>
            <!-- Removed manual background divs as btn-brutal/striped handles it -->
          </a>
          <a
            href="https://joinmy.fans/robgrappler"
            class="btn-brutal brutal-shadow-gold btn-striped-light group relative inline-flex w-full sm:w-auto items-center justify-center border-2 border-[#ECE7DD] bg-black/40 px-10 py-4 text-sm font-bold tracking-[0.2em] uppercase text-[#ECE7DD] transition-all backdrop-blur-sm"
          >
            <span class="relative z-10">Browse library</span>
            <!-- Removed manual background divs as btn-brutal/striped handles it -->
          </a>
        </div>

        <!-- Trust badges -->
        <div
          class="mt-12 sm:mt-16 flex flex-wrap items-center justify-center gap-6 text-[10px] font-bold uppercase tracking-[0.3em] text-zinc-500"
        >
          <div class="flex items-center gap-2">
            <span
              class="h-1.5 w-1.5 rounded-full bg-rg-gold shadow-[0_0_8px_rgba(245,194,101,0.5)]"
            ></span>
            <span>No Scripts</span>
          </div>
          <div class="flex items-center gap-2">
            <span
              class="h-1.5 w-1.5 rounded-full bg-rg-gold shadow-[0_0_8px_rgba(245,194,101,0.5)]"
            ></span>
            <span>Secure Payment</span>
          </div>
          <div class="flex items-center gap-2">
            <span
              class="h-1.5 w-1.5 rounded-full bg-rg-gold shadow-[0_0_8px_rgba(245,194,101,0.5)]"
            ></span>
            <span>HD 60FPS</span>
          </div>
        </div>

        <!-- Scroll indicator -->
        <div class="mt-8 sm:mt-12 flex justify-center">
          <a
            href="#matches"
            class="inline-flex h-9 w-9 items-center justify-center rounded-full border border-white/30 text-white/70 hover:border-rg-gold hover:text-rg-gold transition-colors"
          >
            <span class="sr-only">Scroll to matches</span>
            <svg
              class="h-4 w-4"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </div>
</section>

<style></style>

<script>
  console.log('Hero.astro script started');
  // Device and connection detection for optimal video selection
  function selectOptimalVideo() {
    const video = document.getElementById('hero-video') as HTMLVideoElement;
    console.log('Video element found:', !!video);
    if (!video) return;

    // Get screen dimensions for device detection
    const screenWidth = window.screen.width;
    const screenHeight = window.screen.height;
    const pixelRatio = window.devicePixelRatio || 1;
    
    // Get connection information if available
    const nav = navigator as any;
    const connection = nav.connection || nav.mozConnection || nav.webkitConnection;
    let connectionSpeed = '4g'; // default to fast connection
    let saveData = false;
    
    if (connection) {
      // Determine connection quality
      if (connection.saveData) {
        saveData = true;
      } else if (connection.effectiveType) {
        connectionSpeed = connection.effectiveType; // 'slow-2g', '2g', '3g', '4g'
      } else if (connection.downlink) {
        // Fallback: use downlink speed in Mbps
        const downlink = connection.downlink;
        if (downlink < 0.5) connectionSpeed = '2g';
        else if (downlink < 1.5) connectionSpeed = '3g';
        else connectionSpeed = '4g';
      }
    }

    // Device detection based on screen size and pixel density
    let videoQuality = '720p';
    
    // Check for high-resolution displays
    const effectiveWidth = screenWidth * pixelRatio;
    const effectiveHeight = screenHeight * pixelRatio;
    
    if (saveData) {
      // Always use lowest quality on data saver mode
      videoQuality = '720p';
    } else if (connectionSpeed === 'slow-2g' || connectionSpeed === '2g') {
      // Use lowest quality for slow connections
      videoQuality = '720p';
    } else if (connectionSpeed === '3g') {
      // Medium quality for 3g
      if (effectiveWidth >= 1920 || effectiveHeight >= 1080) {
        videoQuality = '1080p';
      } else {
        videoQuality = '720p';
      }
    } else {
      // Fast connection (4g+) - select based on device capabilities
      if (effectiveWidth >= 2560 || effectiveHeight >= 1440) {
        videoQuality = '1440p';
      } else if (effectiveWidth >= 1920 || effectiveHeight >= 1080) {
        videoQuality = '1080p';
      } else {
        videoQuality = '720p';
      }
    }

    // Mobile device detection for additional optimization
    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    if (isMobile && connectionSpeed !== '4g') {
      videoQuality = '720p'; // Conservative for mobile on slower connections
    }

    // Update video source by reordering the source elements
    const sources = video.querySelectorAll('source');
    const videoPath = `/media/HERO_LOOP_${videoQuality}.mp4`;
    console.log('Video selected:', videoQuality, 'Path:', videoPath);
    console.log('Available sources:', Array.from(sources).map(s => s.src));

    // Find and move the selected source to the top
    let sourceFound = false;
    sources.forEach(source => {
      if (!sourceFound && source.src.includes(videoQuality)) {
        video.insertBefore(source, video.firstChild);
        video.load(); // Reload video with new source order
        sourceFound = true;
        console.log('Source reordered and video loaded');
      }
    });

    // Try to play the video
    video.play().catch((error: any) => {
      console.warn('Video autoplay failed:', error);
    });
  }

  // Initialize video selection when DOM is ready
  document.addEventListener('DOMContentLoaded', selectOptimalVideo);
  
  // Re-evaluate on window resize (for device orientation changes)
  let resizeTimeout: number;
  window.addEventListener('resize', () => {
    clearTimeout(resizeTimeout);
    resizeTimeout = window.setTimeout(selectOptimalVideo, 500);
  });

  // Listen for connection changes
  const nav = navigator as any;
  const connection = nav.connection || nav.mozConnection || nav.webkitConnection;
  if (connection) {
    connection.addEventListener('change', selectOptimalVideo);
  }
</script>
